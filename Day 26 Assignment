# Assignment 1: Create a database library.db with a table books (id, title, author, year)
import sqlite3

conn = sqlite3.connect('library.db')
cursor = conn.cursor()

cursor.execute('''CREATE TABLE IF NOT EXISTS books 
                  (id INTEGER PRIMARY KEY, title TEXT, author TEXT, year INTEGER)''')

# Assignment 2: Insert at least 5 books into the table
books_data = [
    (1, "The God of Small Things", "Arundhati Roy", 1997),
    (2, "Midnight's Children", "Salman Rushdie", 1981),
    (3, "Sacred Games", "Vikram Chandra", 2006),
    (4, "The Mahabharata", "R.K. Narayan", 2016),
    (5, "Train to Pakistan", "Khushwant Singh", 1956)
]

cursor.executemany("INSERT INTO books VALUES (?, ?, ?, ?)", books_data)

# Assignment 3: Fetch and display all books
cursor.execute("SELECT * FROM books")
all_books = cursor.fetchall()
for book in all_books:
    print(book)

# Assignment 4: Write a query to show only books published after 2015
cursor.execute("SELECT * FROM books WHERE year > 2015")
recent_books = cursor.fetchall()
print("Books published after 2015:")
for book in recent_books:
    print(book)

# Assignment 5: Update one book's title
cursor.execute("UPDATE books SET title = 'The Guide' WHERE id = 4")

# Assignment 6: Delete a book record
cursor.execute("DELETE FROM books WHERE id = 5")

conn.commit()
conn.close()

# Assignment 7: Create a simple menu-driven Python program
import sqlite3

def add_book():
    conn = sqlite3.connect('library.db')
    cursor = conn.cursor()
    title = input("Enter book title: ")
    author = input("Enter author name: ")
    year = int(input("Enter publication year: "))
    cursor.execute("INSERT INTO books (title, author, year) VALUES (?, ?, ?)", (title, author, year))
    conn.commit()
    conn.close()
    print("Book added successfully!")

def view_all_books():
    conn = sqlite3.connect('library.db')
    cursor = conn.cursor()
    cursor.execute("SELECT * FROM books")
    books = cursor.fetchall()
    for book in books:
        print(f"ID: {book[0]}, Title: {book[1]}, Author: {book[2]}, Year: {book[3]}")
    conn.close()

def search_by_author():
    conn = sqlite3.connect('library.db')
    cursor = conn.cursor()
    author = input("Enter author name to search: ")
    cursor.execute("SELECT * FROM books WHERE author LIKE ?", (f"%{author}%",))
    books = cursor.fetchall()
    for book in books:
        print(f"Title: {book[1]}, Author: {book[2]}, Year: {book[3]}")
    conn.close()

def main_menu():
    while True:
        print("\n--- Library Management by Rahul Verma ---")
        print("1. Add Book")
        print("2. View All Books") 
        print("3. Search by Author")
        print("4. Exit")
        
        choice = input("Enter your choice (1-4): ")
        
        if choice == "1":
            add_book()
        elif choice == "2":
            view_all_books()
        elif choice == "3":
            search_by_author()
        elif choice == "4":
            print("Thank you for using Library Management System!")
            break
        else:
            print("Invalid choice! Please try again.")

if __name__ == "__main__":
    main_menu()
